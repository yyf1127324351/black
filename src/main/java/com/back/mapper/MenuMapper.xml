<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.back.dao.MenuDao">

    <sql id="sql_menu_column">
		m.id,
		m.name,
		m.code,
		m.type,
		m.parent_id	parentId,
		m.level,
		m.url,
		m.has_child	hasChild,
		m.sort
	</sql>

	<select id="leftLevel1List" resultType="com.back.model.Menu">
		select
		<include refid="sql_menu_column"/>
		from menu m where m.id in (select
		m2.parent_id
		from menu m2
		join menu_user mu on mu.menu_id = m2.id
		where mu.user_id = #{operatorId} and m2.type = 0 and m2.`level` = 2
		) order by m.sort
	</select>
    <select id="leftLevel2List" resultType="com.back.model.Menu">
        select
		<include refid="sql_menu_column"/>
		from menu m
		join menu_user mu on mu.menu_id = m.id
		where mu.user_id = #{operatorId} and m.type = 0  and m.`level` = 2
		order by  m.sort asc
    </select>
    <select id="getAllMenuTree" resultType="com.back.model.Menu">
        select
        <include refid="sql_menu_column"/>
        FROM menu m
        WHERE m.deleted = 0
    </select>
</mapper>